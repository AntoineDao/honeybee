language: python

python: "2.7"

before_install:
 # install radiance
 - wget https://github.com/NREL/Radiance/releases/download/5.2.1/radiance-5.2.91bcc23df3-Linux.tar.gz
 - tar -xzvf radiance-5.2.91bcc23df3-Linux.tar.gz
 - sudo cp -a radiance-5.2.91bcc23df3-Linux/usr/local/radiance/bin/. /usr/local/bin
 - sudo cp -a radiance-5.2.91bcc23df3-Linux/usr/local/radiance/lib/. /usr/local/lib/ray
 - sudo apt-get install libtiff5

install:
 - sudo pip install --upgrade pip
 - sudo pip install pytest pytest-cov coveralls
 - sudo pip install lbt-ladybug

script:
  - py.test --cov=. ./tests/

after_success:
  - coverage report
  - coveralls


jobs:
  include:
    - stage: deploy
      services:
        - docker
      if: branch = master AND (NOT type IN (pull_request))
      language: node_js
      node_js: "8"
      env: TRAVIS=true
      script:
        - git config --global user.name "ladybugbot"
        - git config --global user.email "release@ladybug.tools"
        - npm install @semantic-release/exec
        - npx semantic-release
        
